<?xml version="1.0" encoding="UTF-8"?>
<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui"
          onLoad="Ribbon_OnLoad">
	<ribbon startFromScratch="false">
		<tabs>
			<tab id="VDG_Tab" label="Visio Diagram Generator">

				<!-- 1) Input Source -->
				<group id="VDG_SourceGroup" label="Input Source">
					<editBox id="VDG_SourcePath"
							 label="Source"
							 sizeString="C:\path\to\your\code\"
							 getText="Ribbon_GetSourcePath"
							 onChange="Ribbon_OnSourcePathChanged" />
					<button id="VDG_BrowseSource"
							label="Browse…"
							imageMso="FileOpenDialog"
							onAction="Ribbon_OnBrowseSource" />
					<button id="VDG_LoadConfig"
							label="Load Config…"
							imageMso="FileOpen"
							onAction="Ribbon_OnLoadConfig" />
				</group>

				<!-- 2) Settings -->
				<group id="VDG_SettingsGroup" label="Settings">
					<dropDown id="VDG_Layout"
							  label="Layout"
							  getItemCount="Ribbon_GetLayoutCount"
							  getItemLabel="Ribbon_GetLayoutLabel"
							  getSelectedItemIndex="Ribbon_GetLayoutSelectedIndex"
							  onAction="Ribbon_OnLayoutChanged" />
					<dropDown id="VDG_ExportFormat"
							  label="Export"
							  getItemCount="Ribbon_GetExportCount"
							  getItemLabel="Ribbon_GetExportLabel"
							  getSelectedItemIndex="Ribbon_GetExportSelectedIndex"
							  onAction="Ribbon_OnExportChanged" />
					<toggleButton id="VDG_UseFakeVisio"
								  label="Fake Visio (dev)"
								  getPressed="Ribbon_GetUseFakeVisio"
								  onAction="Ribbon_OnUseFakeVisioToggled"
								  screentip="Use Fake Visio"
								  supertip="Keeps COM out of early smoke tests." />
				</group>

				<!-- 3) Run -->
				<group id="VDG_RunGroup" label="Run">
					<button id="VDG_Generate"
							label="Generate"
							size="large"
							imageMso="ShapesInsertMenu"
							onAction="Ribbon_OnGenerate"
							screentip="Generate Diagram"
							supertip="Read source &amp; settings, build the diagram in Visio." />
					<button id="VDG_Preview"
							label="Preview (Web)"
							imageMso="FileSaveAsWebPage"
							onAction="Ribbon_OnPreview"
							screentip="Preview in Browser"
							supertip="If Visio isn’t available, open a web preview." />
					<button id="VDG_OpenLastOutput"
							label="Open Last Output"
							imageMso="FileOpen"
							getEnabled="Ribbon_CanOpenLastOutput"
							onAction="Ribbon_OnOpenLastOutput"
							screentip="Open Last .vsdx"
							supertip="Open the most recently generated Visio file." />
				</group>

			</tab>
		</tabs>
	</ribbon>
</customUI>
